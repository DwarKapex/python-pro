# Описание
Жил-был чудный веб-интерфейса и все у него было хорошо: в него ходили
пользователи, что-то там кликали, переходили по ссылкам, получали результат. Но
со временем некоторые его странички стали тупить и долго грузиться. Менеджеры
часто жалуются, мол "вот тут список долго грузился" или "интерфейсик тупит,
поиск не работает". Но так трудно отделить те случаи, где проблемы на их стороне,
а где действительно виноват веб-сервис. В логи reverse proxy перед интерфейсом
(nginx) добавили время запроса ($request_time в nginx
http://nginx.org/en/docs/http/ngx_http_log_module.html#log_format). Теперь можно
распарсить логи и провести первичный анализ, выявив подозрительные URL'ы.

Полное TЗ можно почитать [здесь](homework.pdf)

## Запуск
Рекомендуется всегда работать в виртуальной среде, чтобы не засорять
систему. Для удобства был создан Makefile с основными командами.
Чтобы установить зависимости для log_parser, выполните следующую команду:
```bash
$> make install
```

Это команда создаст виртуальую среду в папку `.venv` и установит нужные
зависимости в неё для работы приложения.

Для запуска скрита, используйте следующий вариант:
```bash
$> python src/log_analyzer.py
```


По умолчанию, скрипт использует следующие настройки:
```json
{
 "REPORT_SIZE": 1000,
 "REPORT_DIR": "./reports",
 "LOG_DIR": "./log"
}

```

где
* `REPORT_SIZE` -- это максимальное количество URL в отчете,
* `REPORT_DIR` -- папка, куда складывать отчеты,
* `LOG_DIR` -- папка, где лежат логи. Так же вы можете указать файл `LOG_FILE`, куда будут сохраняться логи от работы парсера.

Изменения настроек парсера проиходит через флаг `--config <config_file_path>`, где *config_file_path* -- путь до настроек
в формате JSON.

## Development
Если вы хотете настроить среду и для дальнейшего улучшения скрита, то попросите об этом Makefile:
```bash
$> make dev
```

Это поставить все записимости в вашу `.venv` и сделает настройки, такие как *pre-commit*.

## Статический анализатор кода

При попытки внести очереные изменения кода в локальный git-репозиторий, будет запущена статическая проверка кода такими
пакетами как *flake8*, *pylint*, *black* и т.д. Если вы хотите сделать такую проверку до коммита, натыкайте в
командной строке:
```bash
$> make lint
```

И исправляйте ошибки =)
